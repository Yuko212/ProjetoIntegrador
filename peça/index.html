<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuração da Peça - CiberTech</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../peça/peça.css"> 
</head>
<body>

    <main class="config-container">
        
        <section class="config-painel-esquerdo">
            
            <div class="config-card">
                <h2 class="config-card-titulo">Peça simples ou Dupla?</h2>
                
                <div class="opcao-radio">
                    <input type="checkbox" id="simples" name="tipo-peca" value="simples" class="checkbox-custom" checked>
                    <label for="simples" class="label-custom">
                        Simples <br> (1 pino com 3 formas)
                    </label>
                </div>

                <div class="opcao-radio">
                    <input type="checkbox" id="dupla" name="tipo-peca" value="dupla" class="checkbox-custom">
                    <label for="dupla" class="label-custom">
                        Dupla <br> (2 pinos com 3 formas cada)
                    </label>
                </div>
            </div>

            <button type="submit" class="botao-finalizar">
                Finalizar
            </button>

            <div class="config-logo-rodape">
                <a href="index.html" class="logo">
                    <span class="logo-text">CiberTech</span>
                </a>
            </div>

        </section>

        <section class="config-painel-direito">
            
            <div class="config-card">
                <h2 class="config-card-titulo">Escolha a ordem da sua peça</h2>
                
                <!-- PRIMEIRA FORMA -->
                <div class="form-grupo">
                    <label class="label-dropdown">Primeira forma</label>
                    <div class="dropdown-container">
                        <span class="dropdown-text">Selecione...</span>
                        <span class="dropdown-clear">×</span>
                        <select class="dropdown-select" id="forma-1">
                            <option value="">Selecione...</option>
                            <option value="circulo">Círculo</option>
                            <option value="quadrado">Quadrado</option>
                            <option value="octogono">Octógono</option>
                        </select>
                        <span class="dropdown-arrow">v</span>
                    </div>
                    <div class="dropdown-opcoes">
                        <span class="dropdown-item" data-value="circulo">Círculo</span>
                        <span class="dropdown-item" data-value="quadrado">Quadrado</span>
                        <span class="dropdown-item" data-value="octogono">Octógono</span>
                    </div>
                </div>

                <!-- SEGUNDA FORMA -->
                <div class="form-grupo">
                    <label class="label-dropdown">Segunda forma</label>
                    <div class="dropdown-container">
                        <span class="dropdown-text">Selecione...</span>
                        <span class="dropdown-clear">×</span>
                        <select class="dropdown-select" id="forma-2">
                            <option value="">Selecione...</option>
                            <option value="circulo">Círculo</option>
                            <option value="quadrado">Quadrado</option>
                            <option value="octogono">Octógono</option>
                        </select>
                        <span class="dropdown-arrow">v</span>
                    </div>
                    <div class="dropdown-opcoes">
                        <span class="dropdown-item" data-value="circulo">Círculo</span>
                        <span class="dropdown-item" data-value="quadrado">Quadrado</span>
                        <span class="dropdown-item" data-value="octogono">Octógono</span>
                    </div>
                </div>

                <!-- TERCEIRA FORMA -->
                <div class="form-grupo">
                    <label class="label-dropdown">Terceira forma</label>
                    <div class="dropdown-container">
                        <span class="dropdown-text">Selecione...</span>
                        <span class="dropdown-clear">×</span>
                        <select class="dropdown-select" id="forma-3">
                            <option value="">Selecione...</option>
                            <option value="circulo">Círculo</option>
                            <option value="quadrado">Quadrado</option>
                            <option value="octogono">Octógono</option>
                        </select>
                        <span class="dropdown-arrow">v</span>
                    </div>
                    <div class="dropdown-opcoes">
                        <span class="dropdown-item" data-value="circulo">Círculo</span>
                        <span class="dropdown-item" data-value="quadrado">Quadrado</span>
                        <span class="dropdown-item" data-value="octogono">Octógono</span>
                    </div>
                </div>

            </div>

        </section>

    </main>

    <!-- SCRIPT CORRIGIDO -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {

        const formGroups = document.querySelectorAll('.form-grupo');
        const allSelects = document.querySelectorAll('.dropdown-select');
        const allOptionGroups = document.querySelectorAll('.dropdown-opcoes');

        function updateAvailableOptions() {
            const selectedValues = new Set();
            allSelects.forEach(select => {
                if (select.value) selectedValues.add(select.value);
            });

            allOptionGroups.forEach(optionsContainer => {
                const currentSelect = optionsContainer.closest('.form-grupo').querySelector('.dropdown-select');

                optionsContainer.querySelectorAll('.dropdown-item').forEach(item => {
                    const itemValue = item.dataset.value;

                    if (selectedValues.has(itemValue) && itemValue !== currentSelect.value) {
                        item.classList.add('desabilitado');
                    } else {
                        item.classList.remove('desabilitado');
                    }
                });
            });
        }

        formGroups.forEach(group => {

            const container = group.querySelector('.dropdown-container');
            const selectElement = group.querySelector('.dropdown-select');
            const dropdownOpcoes = group.querySelector('.dropdown-opcoes');
            const textSpan = group.querySelector('.dropdown-text');
            const clearBtn = group.querySelector('.dropdown-clear');

            dropdownOpcoes.style.display = 'none';

            function refreshVisual() {
                if (selectElement.value) {
                    textSpan.textContent = selectElement.options[selectElement.selectedIndex].text;
                } else {
                    textSpan.textContent = "Selecione...";
                }
            }

            container.addEventListener('click', function(event) {
                if (event.target === clearBtn) return;

                event.stopPropagation();

                allOptionGroups.forEach(otherOptions => {
                    if (otherOptions !== dropdownOpcoes) {
                        otherOptions.style.display = 'none';
                    }
                });

                dropdownOpcoes.style.display =
                    dropdownOpcoes.style.display === 'none' ? 'block' : 'none';
            });

            dropdownOpcoes.querySelectorAll('.dropdown-item').forEach(item => {
                item.addEventListener('click', function(event) {
                    event.stopPropagation();

                    if (item.classList.contains('desabilitado')) return;

                    selectElement.value = item.dataset.value;
                    textSpan.textContent = item.textContent;

                    dropdownOpcoes.style.display = 'none';
                    updateAvailableOptions();
                });
            });

            clearBtn.addEventListener("click", function(event) {
                event.stopPropagation();

                selectElement.value = "";
                textSpan.textContent = "Selecione...";
                updateAvailableOptions();
                dropdownOpcoes.style.display = "none";
            });

            refreshVisual();
        });

        document.addEventListener('click', function(event) {
            allOptionGroups.forEach(options => {
                const container = options.closest('.form-grupo').querySelector('.dropdown-container');

                if (!container.contains(event.target)) {
                    options.style.display = 'none';
                }
            });
        });

        updateAvailableOptions();
    });
    </script>

</body>
</html>
